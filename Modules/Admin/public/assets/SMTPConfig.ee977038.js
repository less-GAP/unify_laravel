import{e as d,f as _,r as m,c as P,a as e,h as o,x as g,F as q,b as y,A as c,o as M,k as w,w as k}from"./index.a683e63c.js";import{v as F}from"./validateMessages.02f7ed2e.js";import"https://cdn.jsdelivr.net/npm/surrealdb.js";const N=y("h3",{class:"font-bold"},"SMTP Config",-1),B=y("hr",{class:"mb-6 mt-4"},null,-1),$={__name:"SMTPConfig",emits:["success","cancel"],setup(V,{emit:S}){const T=["smtp_server","smtp_port","smtp_security","smtp_user","smtp_password","smtp_email_from"],n=d(!1);d(null);const p=d(!1),a=_({}),f=_({email_to:""}),i=_({validateTrigger:"submit","label-align":"top",model:a,labelCol:{span:8},wrapperCol:{span:16},"validate-messages":F});(function(){n.value=!0,c.get("config",{params:{names:T}}).then(s=>{Object.assign(a,s.data)}).catch(s=>{}).finally(n.value=!1)})();const U=async function(){n.value=!0,c.post("config",a).then(s=>{S("success",s)}).catch(s=>{}).finally(n.value=!1)},x=async function(){c.post("config/testSmtp",{...a,...f}).then(s=>{p.value=!1}).catch(s=>{}).finally(n.value=!1)};return(s,t)=>{const u=m("a-input"),r=m("a-form-item"),v=m("a-button"),C=m("a-space"),b=m("a-form"),h=m("a-modal");return M(),P(q,null,[N,B,e(b,g({style:{"max-width":"600px"},autocomplete:"off",model:a},i,{onFinish:U}),{default:o(()=>[e(r,{name:"smtp_server",label:"SMTP Server",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"domain.com",autocomplete:"off",value:a.smtp_server,"onUpdate:value":t[0]||(t[0]=l=>a.smtp_server=l)},null,8,["value"])]),_:1}),e(r,{name:"smtp_port",label:"SMTP Port",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"25",autocomplete:"off",value:a.smtp_port,"onUpdate:value":t[1]||(t[1]=l=>a.smtp_port=l)},null,8,["value"])]),_:1}),e(r,{name:"smtp_security",label:"Security",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"tls",autocomplete:"off",value:a.smtp_security,"onUpdate:value":t[2]||(t[2]=l=>a.smtp_security=l)},null,8,["value"])]),_:1}),e(r,{name:"smtp_user",label:"User",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"User",autocomplete:"off",value:a.smtp_user,"onUpdate:value":t[3]||(t[3]=l=>a.smtp_user=l)},null,8,["value"])]),_:1}),e(r,{name:"smtp_password",label:"Password",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"Password",type:"password",autocomplete:"off",value:a.smtp_password,"onUpdate:value":t[4]||(t[4]=l=>a.smtp_password=l)},null,8,["value"])]),_:1}),e(r,{name:"smtp_email_from",label:"From email",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"test@example.com",autocomplete:"off",value:a.smtp_email_from,"onUpdate:value":t[5]||(t[5]=l=>a.smtp_email_from=l)},null,8,["value"])]),_:1}),e(r,{"wrapper-col":{...i.wrapperCol,offset:8}},{default:o(()=>[e(C,null,{default:o(()=>[e(v,{loading:n.value,type:"primary","html-type":"submit"},{default:o(()=>[w("Submit")]),_:1},8,["loading"]),e(v,{onClick:t[6]||(t[6]=k(l=>p.value=!0,["prevent"]))},{default:o(()=>[w("Test")]),_:1})]),_:1})]),_:1},8,["wrapper-col"])]),_:1},16,["model"]),e(h,{open:p.value,"onUpdate:open":t[8]||(t[8]=l=>p.value=l),title:"Send Test Email",onOk:x},{default:o(()=>[e(b,g({class:"p-8",autocomplete:"off"},i,{model:f}),{default:o(()=>[e(r,{class:"w-full",name:"email_to",label:"Send to email",rules:[{required:!0}]},{default:o(()=>[e(u,{placeholder:"test@example.com",autocomplete:"off",value:f.email_to,"onUpdate:value":t[7]||(t[7]=l=>f.email_to=l)},null,8,["value"])]),_:1})]),_:1},16,["model"])]),_:1},8,["open"])],64)}}};export{$ as default};
