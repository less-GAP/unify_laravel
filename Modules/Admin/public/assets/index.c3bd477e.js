import{e as v,v as X,r as o,o as u,c as f,a as e,h as t,b as r,m as D,x as V,k as w,q as U,D as Y,F as z,A as T,_ as Z,p as F,y as ee,l as j,U as te,R as ae,n as q,z as le,B as ne,C as oe,E as ie,G as se,d as ue,H as B,I as re}from"./index.a683e63c.js";import{I as de}from"./InputUploadGetPath.6754ab8e.js";import"https://cdn.jsdelivr.net/npm/surrealdb.js";const ce={class:"pr-[10px]"},pe={class:"mt-2"},fe=r("p",{class:"p-2 pl-0 pb-0",id:"alt-text-description"},[r("a",{class:"text-main",href:"https://www.w3.org/WAI/tutorials/images/decision-tree",target:"_blank",rel:"noopener"},[w(" Learn how to describe the purpose of the image"),r("span",{class:"screen-reader-text"}," (opens in a new tab)")]),w(". Leave empty if the image is purely decorative. ")],-1),me={__name:"FileDetailForm",props:{value:{type:Object,default:{}}},emits:["delete"],setup(a,{emit:_}){const d=a,c=v(!1),s=v({});X(()=>d.value,async()=>{s.value=d.value});const $=async function(){c.value=!0,await T.post("file/Info",s.value,{}),c.value=!1},h=async function(){await T.delete("file/"+d.value.id),_("delete")};return(g,m)=>{const S=o("question-circle-outlined"),x=o("a-button"),N=o("a-popconfirm"),y=o("a-form-item"),I=o("a-form"),k=o("a-descriptions-item"),P=o("a-col"),i=o("a-descriptions"),l=o("a-row"),C=o("a-divider"),b=o("a-input"),A=o("a-textarea");return u(),f(z,null,[e(l,{wrap:!1},{default:t(()=>[e(P,{flex:"210px"},{default:t(()=>{var p;return[r("div",ce,[e(D(de),{dir:a.value.file_dir,id:(p=a.value)==null?void 0:p.id,buttonConfig:{type:"primary"},label:"Replace",value:a.value.site_path,"onUpdate:value":m[0]||(m[0]=R=>a.value.site_path=R)},null,8,["dir","id","value"]),e(k,{label:""},{default:t(()=>[e(I,V({onFinish:$},g.$config.formConfig,{model:s.value}),{default:t(()=>[e(y,null,{default:t(()=>[e(N,{onConfirm:h,title:"Are you sure\uFF1F"},{icon:t(()=>[e(S,{style:{color:"red"}})]),default:t(()=>[e(x,{type:"primary",danger:"",href:"#"},{default:t(()=>[w("Delete")]),_:1})]),_:1})]),_:1})]),_:1},16,["model"])]),_:1})])]}),_:1}),e(P,{flex:"auto"},{default:t(()=>[e(i,{size:"small",column:1},{default:t(()=>[e(k,{label:"Uploaded on"},{default:t(()=>[r("b",null,U(g.$format.formatDateTime(a.value.created_at)),1)]),_:1}),e(k,{label:"Uploaded by"},{default:t(()=>[r("b",null,U(a.value.created_by),1)]),_:1}),e(k,{label:"File name"},{default:t(()=>[r("b",null,U(a.value.file_name),1)]),_:1}),e(k,{label:"File type"},{default:t(()=>[r("b",null,U(a.value.file_ext),1)]),_:1}),e(k,{label:"File size"},{default:t(()=>[r("b",null,U(g.$format.humanFileSize(a.value.file_size)),1)]),_:1})]),_:1}),r("div",pe,[e(x,{type:"primary",target:"_blank",download:a.value.file_name,href:a.value.file_url},{default:t(()=>[e(D(Y)),w(" Download ")]),_:1},8,["download","href"])])]),_:1})]),_:1}),e(C),e(I,V({onFinish:$},g.$config.formConfig,{model:s.value}),{default:t(()=>[e(y,{label:"Title"},{default:t(()=>[e(b,{value:s.value.title,"onUpdate:value":m[1]||(m[1]=p=>s.value.title=p)},null,8,["value"])]),_:1}),e(y,{label:"Alternative Text"},{default:t(()=>[e(A,{value:s.value.alternative_text,"onUpdate:value":m[2]||(m[2]=p=>s.value.alternative_text=p)},null,8,["value"]),fe]),_:1}),e(y,{label:"Caption"},{default:t(()=>[e(b,{value:s.value.caption,"onUpdate:value":m[3]||(m[3]=p=>s.value.caption=p)},null,8,["value"])]),_:1}),e(y,{label:"Description"},{default:t(()=>[e(A,{value:s.value.description,"onUpdate:value":m[4]||(m[4]=p=>s.value.description=p)},null,8,["value"])]),_:1}),e(y,null,{default:t(()=>[e(x,{loading:c.value,type:"primary","html-type":"submit"},{default:t(()=>[w("Submit")]),_:1},8,["loading"])]),_:1})]),_:1},16,["model"])],64)}}},ve=a=>(ie("data-v-1bf7f3de"),a=a(),se(),a),_e={class:"relative text-center overflow-x-auto sm:rounded-lg"},he=["loading"],ge=ve(()=>r("span",null,null,-1)),ye={class:"mt-12 mb-12 grid grid-cols-2 md:grid-cols-6 gap-4"},be={class:"cursor-pointer border-2 border-gray-100 hover:border-blue-700 h-[150px] mb-5 rounded-lg overflow:hidden"},we=["onClick"],xe=["title","src"],ke=["title"],Ce={class:"absolute whitespace-nowrap text-center overflow-hidden text-ellipsis -bottom-[40px] bg-white w-full pl-2 pr-2"},Se={key:0,class:"col-span-2 md:col-span-6 w-full bg-white shadow rounded-lg overflow-hidden"},Ae={key:1,class:"col-span-2 md:col-span-6 w-full bg-white shadow rounded-lg overflow-hidden"},Fe={key:0},Ue={key:1},De={__name:"FileManager",props:{config:{type:Object,default:{item_key:"id",rowSelect:!0}},pagination:{type:Object,default:{page:1,total:0,perPage:24}},showSizeChanger:{type:Boolean,default:!0},params:{type:Object,default:{}},columns:Array,selectionActions:{type:Array,default:[]},itemActions:{type:Array,default:[]},addAction:Function},setup(a){const _=a,d={item_key:"id",rowSelect:!0,globalSearch:!0,..._.config},c=v({}),s=v([]),$=v("");function h(){g.value=!0,T.get("file/list",{params:{perPage:_.pagination.perPage,page:_.pagination.page,..._.params,"filter[search]":$.value}}).then(i=>{var l;c.value=i.data,_.pagination.total=(l=i.data)!=null&&l.total?i.data.total:0}).finally(()=>{m.value=!1,g.value=!1})}const g=v(!1),m=v(!1),S=v(null);v([]);const x=v([]);async function N(i){const l=x.value.map(C=>C[d.item_key]);await i.action(l,x.value),i.complete&&i.complete(),x.value=[],h()}async function y(){if(!s.value.length)return;const i=s.value.length-1,l=s.value[i];let C=new FormData;C.append("file",l.file);const b=await T.post("file/Upload",C,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(A){s.value[i].percent=Math.round(A.loaded*100/A.total)}});c.value.data||(c.value.data=[]),s.value.splice(i,1),c.value.data.unshift(b.data),await y()}async function I(i){i.percent=0,s.value.push(i),await y()}function k(i){return/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(i)}function P(i){const l=window.location.host;return l.indexOf("9200")>-1?"//"+l.split(":")[0]+":9100/"+i:"//"+l+"/"+i}return h(),(i,l)=>{var K,L;const C=o("a-input-search"),b=o("a-button"),A=o("a-upload"),p=o("a-space"),R=o("a-menu-item"),M=o("a-menu"),W=o("a-dropdown"),E=o("a-progress"),G=o("a-skeleton"),H=o("a-empty"),J=o("a-pagination"),Q=o("a-drawer");return u(),f(z,null,[r("div",_e,[r("div",{loading:g.value,class:"flex items-center justify-between"},[e(p,null,{default:t(()=>[d.globalSearch?(u(),F(C,{key:0,"allow-clear":"",onKeyup:ee(h,["enter"]),style:{"max-width":"300px"},value:$.value,"onUpdate:value":l[0]||(l[0]=n=>$.value=n),placeholder:"Enter to search...",loading:g.value},null,8,["onKeyup","value","loading"])):j("",!0),e(A,{name:"file",showUploadList:!1,"max-count":10,multiple:"true",customRequest:I},{default:t(()=>[e(b,null,{default:t(()=>[e(D(te)),w(" Click to Upload ")]),_:1})]),_:1})]),_:1}),ge,e(p,null,{default:t(()=>[e(b,null,{icon:t(()=>[e(D(ae),{onClick:h})]),_:1}),a.selectionActions.length>0?(u(),F(W,{key:0,disabled:!x.value.length},{overlay:t(()=>[e(M,null,{default:t(()=>[(u(!0),f(z,null,q(a.selectionActions,(n,O)=>(u(),F(R,{onClick:je=>N(n),key:O},{default:t(()=>[w(U(n.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:t(()=>[e(b,null,{default:t(()=>[w(" H\xE0nh \u0111\u1ED9ng "),e(D(le))]),_:1})]),_:1},8,["disabled"])):j("",!0),a.addAction?(u(),F(b,{key:1,type:"primary",onClick:l[1]||(l[1]=()=>{a.addAction(h)})},{default:t(()=>[w("Th\xEAm m\u1EDBi")]),_:1})):j("",!0)]),_:1})],8,he),r("div",ye,[(u(!0),f(z,null,q(s.value,n=>(u(),f("div",be,[e(E,{type:"circle",percent:n.percent},null,8,["percent"])]))),256)),(u(!0),f(z,null,q(c.value.data,n=>(u(),f("div",{onClick:O=>S.value=n,key:n.id,class:"cursor-pointer relative border-2 border-gray-100 hover:border-blue-700 h-[150px] mb-[50px] rounded-lg overflow:hidden"},[k(n.file_url)?(u(),f("img",{key:0,style:{"max-width":"auto","max-height":"auto"},title:n.file_name,class:"h-full object-contain object-center w-full max-w-full",src:P(n.site_path)},null,8,xe)):(u(),f("div",{key:1,title:n.file_name,class:"h-full flex items-center text-center object-contain object-center w-full max-w-full"},[e(D(ne),{style:{margin:"0 auto","font-size":"30px"}})],8,ke)),r("div",Ce,U(n.file_name),1)],8,we))),128)),c.value.data?j("",!0):(u(),f("div",Se,[e(G,{active:"",class:"p-10"})])),((K=c.value.data)==null?void 0:K.length)===0&&a.pagination.total===0?(u(),f("div",Ae,[e(H,{class:"my-10",description:!1})])):j("",!0)]),(L=a.pagination)!=null&&L.total?(u(),F(J,{key:0,showSizeChanger:a.showSizeChanger,onChange:h,current:a.pagination.page,"onUpdate:current":l[2]||(l[2]=n=>a.pagination.page=n),pageSize:a.pagination.perPage,"onUpdate:pageSize":l[3]||(l[3]=n=>a.pagination.perPage=n),total:a.pagination.total},{itemRender:t(({type:n,originalElement:O})=>[n==="prev"?(u(),f("a",Fe,"Previous")):n==="next"?(u(),f("a",Ue,"Next")):(u(),F(oe(O),{key:2}))]),_:1},8,["showSizeChanger","current","pageSize","total"])):j("",!0)]),e(Q,{style:{"max-width":"100vw"},appendTo:"body",open:S.value,"onUpdate:open":l[5]||(l[5]=n=>S.value=n),class:"custom-class",width:"80vw",title:"File Detail",placement:"right"},{default:t(()=>[e(me,{onDelete:l[4]||(l[4]=n=>{S.value=!1,h()}),value:S.value},null,8,["value"])]),_:1},8,["open"])],64)}}},$e=Z(De,[["__scopeId","data-v-1bf7f3de"]]);ue({name:"BaseButtons",props:{noWrap:Boolean,type:{type:String,default:"justify-start"},classAddon:{type:String,default:"mr-3 last:mr-0 mb-3"},mb:{type:String,default:"-mb-3"}},render(){const a=this.$slots&&this.$slots.default,_=["flex","items-center",this.type,this.noWrap?"flex-nowrap":"flex-wrap"];return this.mb&&_.push(this.mb),B("div",{class:_},a?this.$slots.default().map(d=>d&&d.children&&typeof d.children=="object"?B(d,{},d.children.map(c=>B(c,{class:[this.classAddon]}))):B(d,{class:[this.classAddon]})):null)}});const Oe={__name:"index",setup(a){return v({visible:!1,value:null,success:()=>{},cancel:()=>{}}),v([]),(_,d)=>(u(),F(re,null,{default:t(()=>[e(D($e))]),_:1}))}};export{Oe as default};
