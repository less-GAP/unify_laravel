import{i as h,f as w,e as k,u as I,r as t,p as u,h as s,A as M,o as r,a,b as e,m as n,ab as D,ae as A,q as l,k as B,x as C,c as z,n as G,F as J}from"./index.a683e63c.js";import{D as K}from"./DataTable.1047e308.js";import{U as Q}from"./UseEloquentRouter.7e988003.js";import{U as W}from"./UseDataTable.106f51b0.js";import"https://cdn.jsdelivr.net/npm/surrealdb.js";const X={class:"p-3 bg-gray-200"},Y={class:"flex"},Z=e("span",{class:"ml-1 text-stone-500"},"Back",-1),ee={class:"flex"},te=e("span",{class:"ml-1 text-stone-500"},"Back",-1),se={class:"px-4 mt-5 overflow-y-auto",style:{height:"calc(100% - 60px)"}},ae={class:"flex flex-wrap -mx-4"},oe={class:"flex flex-col w-full px-4"},ne={class:"flex items-center leading-none whitespace-nowrap"},le={class:"text-sm text-gray-400"},ie={class:"w-full px-4 pl-6"},ce={class:"flex items-center"},re=["src"],_e={class:"mx-2 by"},de={class:"ml-auto text-xs text-gray-500"},pe={class:"text-xs"},ue="activity",De={__name:"History",props:{value:{type:Object,default:{}},visible:{type:Boolean,default:!0}},setup(j){const v=h.currentRoute.value.params.id,{fetchDetailApi:R,fetchListApi:S}=Q(ue,{order:"-id"}),T=W(S,{showSelection:!1,globalSearch:!1,pagination:{perPage:10},filter:{subject_id:v,subject_type:"App\\Models\\Patient"}}),f=w({}),i=w({}),x=k(),_=k(!1);I();const N=async function(){_.value=!0;var o=h.currentRoute.value.params.id;if(o!=="new"){_.value=!0;const g=await R(o),d=await M.get(`/patient/${v}`);Object.assign(f,d.data.data),Object.assign(i,g.data),_.value=!1}else _.value=!1};function O({reload:o}){}N();const U=()=>{x.value.validate().then(()=>{updateApi(i.id,{...i}).then(o=>{Object.assign(i,o.data.result)})})},m=function(){h.replace({path:"/patient"})};return(o,g)=>{const d=t("a-button"),$=t("a-space"),F=t("a-Divider"),H=t("a-tag"),P=t("a-timeline-item"),V=t("a-timeline"),q=t("a-empty"),E=t("a-form"),L=t("a-drawer");return r(),u(L,{closable:!1,style:{position:"relative",display:"flex","flex-direction":"column",height:"100vh"},open:j.visible,width:"40vw",onClose:m},{default:s(()=>[a(E,C(o.$config.formConfig,{ref_key:"formRef",ref:x,layout:"vertical",model:i,onFinish:U}),{default:s(()=>[e("div",X,[a(d,{class:"!hidden md:!inline-block",type:"link",onClick:m},{icon:s(()=>[e("div",Y,[a(n(D),{path:n(A),class:"w-4 text-stone-500"},null,8,["path"]),Z])]),_:1}),a(d,{class:"!inline-flex items-center justify-center md:!hidden !w-8 !h-8 !p-0",type:"link",onClick:m},{icon:s(()=>[e("div",ee,[a(n(D),{path:n(A),class:"w-4 text-stone-500"},null,8,["path"]),te])]),_:1}),a($,{class:"float-right"})]),e("div",se,[e("div",ae,[e("h1",oe,[e("div",ne,[e("span",null,l(f.full_name),1)]),e("div",le," #"+l(f.unify_number),1)]),a(F,{class:"!font-bold !text-blue-700",dashed:"",orientation:"left","orientation-margin":"1rem",plain:""},{default:s(()=>[B(" History ")]),_:1}),e("div",ie,[a(n(K),C(n(T),{onRegister:O}),{table:s(({tableConfig:fe,tableData:me,data:p,columns:he,selectionActions:ve,reload:xe})=>[p!=null&&p.length?(r(),u(V,{key:0,class:"!m-5"},{default:s(()=>[(r(!0),z(J,null,G(p,c=>(r(),u(P,{color:"green",class:"!mb-5"},{default:s(()=>{var y,b;return[e("div",ce,[e("img",{class:"w-6 h-6 rounded-full",src:(y=c.causer)==null?void 0:y.profile_photo_url},null,8,re),e("div",_e,l((b=c.causer)==null?void 0:b.full_name),1),a(H,null,{default:s(()=>[B(l(c.event),1)]),_:2},1024),e("div",de," at "+l(o.$format.formatDateTime(c.created_at)),1)]),e("div",pe,l(c.description),1)]}),_:2},1024))),256))]),_:2},1024)):(r(),u(q,{key:1,class:"my-10",description:"No history"}))]),_:1},16)])])])]),_:1},16,["model"])]),_:1},8,["open"])}}};export{De as default};
