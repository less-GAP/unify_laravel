import{f as L,e as h,u as $,r as c,p,h as l,i as b,o as _,a as s,b as a,m as r,ab as g,ae as x,k,q as w,l as D,x as E,a7 as Y,Z as S}from"./index.a683e63c.js";import{l as W,u as z}from"./Patient.e2eb7f50.js";import{U as I}from"./UseEloquentRouter.7e988003.js";import"https://cdn.jsdelivr.net/npm/surrealdb.js";const Z={class:"p-3 bg-gray-200"},G={class:"flex"},J=a("span",{class:"ml-1 text-stone-500"},"Back",-1),K={class:"flex"},Q=a("span",{class:"ml-1 text-stone-500"},"Back",-1),X={class:"px-4 mt-5 overflow-y-auto",style:{height:"calc(100% - 60px)"}},ee={class:"flex flex-wrap -mx-4"},te={class:"block w-full px-4 mb-4 leading-6"},se={class:"text-xs leading-6"},ae={class:"w-full px-4"},C="patient",oe="YYYY-MM-DD",de={__name:"Process",props:{value:{type:Object,default:{}},visible:{type:Boolean,default:!0}},setup(N){const B=W(),{fetchDetailApi:P,deleteApi:ne,updateApi:R}=I(C),e=L({}),m=h(),u=h(!1),A=$(),H=z();var v=[];const M=t=>t.dob?"("+Y().diff(Y(t.dob,oe),"year")+" years old)":"",T=t=>{S[t]({message:"Warning: Need to do",description:"Please check list need to do on Task tab and complete it before Approve new patient"})};(async function(){u.value=!0;var t=b.currentRoute.value.params.id;if(t!=="new"){u.value=!0;const o=await P(t);Object.assign(e,o.data.data),H.forEach(n=>{e[n.key]!=null&&e[n.key]!==0||n.key=="doctor_id"&&e[n.key]!==null||v.push({value:n.key,label:n.noti})}),u.value=!1}else u.value=!1})();const y=()=>{m.value.validate().then(()=>{if(v.length>0&&e.unify_process==2)return T("warning"),!1;e.unify_process==2&&(e.unify_status=1),R(e.id,{...e}).then(t=>{Object.assign(e,t.data.result)})})},d=function(){b.replace({path:"/"+C})};return(t,o)=>{const n=c("a-button"),U=c("a-space"),j=c("a-select"),f=c("a-form-item"),q=c("a-date-picker"),O=c("a-textarea"),V=c("a-form"),F=c("a-drawer");return _(),p(F,{closable:!1,style:{position:"relative",display:"flex","flex-direction":"column",height:"100vh"},onClose:d,open:N.visible},{default:l(()=>[s(V,E({layout:"vertical"},t.$config.formConfig,{ref_key:"formRef",ref:m,model:e,onFinish:y}),{default:l(()=>[a("div",Z,[s(n,{class:"!hidden md:!inline-block",type:"link",onClick:d},{icon:l(()=>[a("div",G,[s(r(g),{path:r(x),class:"w-4 text-stone-500"},null,8,["path"]),J])]),_:1}),s(n,{class:"!inline-flex items-center justify-center md:!hidden !w-8 !h-8 !p-0",type:"link",onClick:d},{icon:l(()=>[a("div",K,[s(r(g),{path:r(x),class:"w-4 text-stone-500"},null,8,["path"]),Q])]),_:1}),s(U,{class:"float-right"},{default:l(()=>[s(n,{onClick:o[0]||(o[0]=i=>y()),loading:u.value,type:"primary"},{default:l(()=>[k("Update")]),_:1},8,["loading"])]),_:1})]),a("div",X,[a("div",ee,[a("h3",te,[a("strong",null,w(e.full_name),1),k(),a("span",se,w(M(e)),1)]),a("div",ae,[r(A).user.roles.find(i=>i.name==="Admin")!==!1?(_(),p(f,{key:0,required:"",label:"Choose process",name:"unify_process"},{default:l(()=>[s(j,{class:"w-full",value:e.unify_process,"onUpdate:value":o[1]||(o[1]=i=>e.unify_process=i),options:r(B)},null,8,["value","options"])]),_:1})):D("",!0),e.unify_process==2?(_(),p(f,{key:1,required:"",label:"Publish date"},{default:l(()=>[s(q,{class:"w-full",showTime:{format:"HH:mm"},inputReadOnly:"",value:e.unify_active,"onUpdate:value":o[2]||(o[2]=i=>e.unify_active=i),valueFormat:"YYYY-MM-DD HH:mm:ss",format:"HH:mm MM-DD-YYYY",disabled:e.unify_process!=2},null,8,["value","disabled"])]),_:1})):D("",!0),s(f,{required:"",label:"Notes for this change",name:"log_detail"},{default:l(()=>[s(O,{class:"w-full",value:e.log_detail,"onUpdate:value":o[3]||(o[3]=i=>e.log_detail=i),rows:4,"auto-size":{minRows:4,maxRows:8}},null,8,["value"])]),_:1})])])])]),_:1},16,["model"])]),_:1},8,["open"])}}};export{de as default};
